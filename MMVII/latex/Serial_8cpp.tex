\hypertarget{Serial_8cpp}{}\section{src/\+Serial/\+Serial.cpp File Reference}
\label{Serial_8cpp}\index{src/\+Serial/\+Serial.\+cpp@{src/\+Serial/\+Serial.\+cpp}}


Implementation of serialisation servive.  


{\ttfamily \#include \char`\"{}include/\+M\+M\+V\+I\+I\+\_\+all.\+h\char`\"{}}\\*
{\ttfamily \#include $<$boost/algorithm/cxx14/equal.\+hpp$>$}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classMMVII_1_1cAr2007}{M\+M\+V\+I\+I\+::c\+Ar2007}
\item 
class \hyperlink{classMMVII_1_1cXMLEOF}{M\+M\+V\+I\+I\+::c\+X\+M\+L\+E\+OF}
\begin{DoxyCompactList}\small\item\em Class for recuperating End Of File error. \end{DoxyCompactList}\item 
class \hyperlink{classMMVII_1_1cIXml__Ar2007}{M\+M\+V\+I\+I\+::c\+I\+Xml\+\_\+\+Ar2007}
\begin{DoxyCompactList}\small\item\em Xml read archive. \end{DoxyCompactList}\item 
class \hyperlink{classMMVII_1_1cOXml__Ar2007}{M\+M\+V\+I\+I\+::c\+O\+Xml\+\_\+\+Ar2007}
\begin{DoxyCompactList}\small\item\em Xml write archive. \end{DoxyCompactList}\item 
class \hyperlink{classMMVII_1_1cOBin__Ar2007}{M\+M\+V\+I\+I\+::c\+O\+Bin\+\_\+\+Ar2007}
\begin{DoxyCompactList}\small\item\em binary write archive \end{DoxyCompactList}\item 
class \hyperlink{classMMVII_1_1cIBin__Ar2007}{M\+M\+V\+I\+I\+::c\+I\+Bin\+\_\+\+Ar2007}
\begin{DoxyCompactList}\small\item\em binary read archive \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{Serial_8cpp_a4e471bcc9503d98767ace8543068737b}{M\+M\+V\+I\+I\+::\+Delete\+Ar} (c\+Ar2007 $\ast$)\hypertarget{Serial_8cpp_a4e471bcc9503d98767ace8543068737b}{}\label{Serial_8cpp_a4e471bcc9503d98767ace8543068737b}

\begin{DoxyCompactList}\small\item\em Serialization for optional. \end{DoxyCompactList}\item 
void \hyperlink{Serial_8cpp_adde69c2a8c2c7ab9f0d4a04d8a8928e8}{M\+M\+V\+I\+I\+::\+Add\+Data} (const c\+Aux\+Ar2007 \&an\+Aux, int \&a\+Val)
\begin{DoxyCompactList}\small\item\em for int \end{DoxyCompactList}\item 
void \hyperlink{Serial_8cpp_a0ffdebec93d46fafe52b030bfa49a920}{M\+M\+V\+I\+I\+::\+Add\+Data} (const c\+Aux\+Ar2007 \&an\+Aux, double \&a\+Val)\hypertarget{Serial_8cpp_a0ffdebec93d46fafe52b030bfa49a920}{}\label{Serial_8cpp_a0ffdebec93d46fafe52b030bfa49a920}

\begin{DoxyCompactList}\small\item\em for double \end{DoxyCompactList}\item 
void \hyperlink{Serial_8cpp_a31e8d68f0461dcacabfaf14ed8828d9c}{M\+M\+V\+I\+I\+::\+Add\+Data} (const c\+Aux\+Ar2007 \&an\+Aux, std\+::string \&a\+Val)\hypertarget{Serial_8cpp_a31e8d68f0461dcacabfaf14ed8828d9c}{}\label{Serial_8cpp_a31e8d68f0461dcacabfaf14ed8828d9c}

\begin{DoxyCompactList}\small\item\em for string \end{DoxyCompactList}\item 
void \hyperlink{Serial_8cpp_ab48041671dff37b74a9451d7433935fe}{M\+M\+V\+I\+I\+::\+Add\+Data} (const c\+Aux\+Ar2007 \&an\+Aux, c\+Pt2dr \&a\+Val)\hypertarget{Serial_8cpp_ab48041671dff37b74a9451d7433935fe}{}\label{Serial_8cpp_ab48041671dff37b74a9451d7433935fe}

\begin{DoxyCompactList}\small\item\em for c\+Pt2dr \end{DoxyCompactList}\item 
void \hyperlink{Serial_8cpp_a3a0b33f7f6aa45023be936610cf5f3bd}{M\+M\+V\+I\+I\+::\+Add\+Data} (const c\+Aux\+Ar2007 \&an\+Aux, t\+Name\+Pair \&a\+Val)\hypertarget{Serial_8cpp_a3a0b33f7f6aa45023be936610cf5f3bd}{}\label{Serial_8cpp_a3a0b33f7f6aa45023be936610cf5f3bd}

\begin{DoxyCompactList}\small\item\em for Pair of string \end{DoxyCompactList}\item 
bool \hyperlink{Serial_8cpp_a95646e7f223361a1c1a4ed1ee0808c06}{M\+M\+V\+I\+I\+::\+Is\+File\+Xml\+Of\+Given\+Tag} (bool Is2007, const std\+::string \&a\+Name, const std\+::string \&a\+Tag)\hypertarget{Serial_8cpp_a95646e7f223361a1c1a4ed1ee0808c06}{}\label{Serial_8cpp_a95646e7f223361a1c1a4ed1ee0808c06}

\begin{DoxyCompactList}\small\item\em Indicate if a file is really X\+ML, created by M\+M\+V\+II and containing the expected Tag. \end{DoxyCompactList}\item 
c\+Ar2007 $\ast$ \hyperlink{Serial_8cpp_ad5a8ee3ebd0b0c4fe5d6ca6e18410bd2}{M\+M\+V\+I\+I\+::\+Alloc\+Ar\+From\+File} (const std\+::string \&a\+Name, bool Input)
\begin{DoxyCompactList}\small\item\em Create an archive structure, its type (xml, binary, text) is determined by extension. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const char $\ast$ {\bfseries M\+M\+V\+I\+I\+::a\+X\+M\+L\+Begin\+Com} = \char`\"{}$<$!-\/-\/\char`\"{}\hypertarget{Serial_8cpp_a6f52b4cfe6ecb19bca2903c29b21ba09}{}\label{Serial_8cpp_a6f52b4cfe6ecb19bca2903c29b21ba09}

\item 
static const char $\ast$ {\bfseries M\+M\+V\+I\+I\+::a\+X\+M\+L\+End\+Com} = \char`\"{}-\/-\/$>$\char`\"{}\hypertarget{Serial_8cpp_a324104788d9a3921d3c47c63fd123b84}{}\label{Serial_8cpp_a324104788d9a3921d3c47c63fd123b84}

\item 
static const char $\ast$ {\bfseries M\+M\+V\+I\+I\+::a\+X\+M\+L\+Begin\+Com2} = \char`\"{}$<$?\char`\"{}\hypertarget{Serial_8cpp_a7558517b0b76e0ba89b3aee116bf9ba8}{}\label{Serial_8cpp_a7558517b0b76e0ba89b3aee116bf9ba8}

\item 
static const char $\ast$ {\bfseries M\+M\+V\+I\+I\+::a\+X\+M\+L\+End\+Com2} = \char`\"{}?$>$\char`\"{}\hypertarget{Serial_8cpp_aa72e9b139d03e4f31f58b6cc23c48883}{}\label{Serial_8cpp_aa72e9b139d03e4f31f58b6cc23c48883}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
Implementation of serialisation servive. 

This serialization principle is very close (at least inspired by) boost one. In fact I hesitated to use boost, but could not find a way satisfying for handling optional value in X\+ML (accept to read old xml file when the structure has grow with optionnale value).

serializing a class, consist essentially to describe serially all its data. This done by defining a function Add\+Data that calling seriall the Add\+Data of its member. See c\+Test\+Serial0, c\+Test\+Serial1 and c\+Test\+Serial2 at the end of this file for examples. 

\subsection{Function Documentation}
\index{Serial.\+cpp@{Serial.\+cpp}!Add\+Data@{Add\+Data}}
\index{Add\+Data@{Add\+Data}!Serial.\+cpp@{Serial.\+cpp}}
\subsubsection[{\texorpdfstring{Add\+Data(const c\+Aux\+Ar2007 \&an\+Aux, int \&a\+Val)}{AddData(const cAuxAr2007 &anAux, int &aVal)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+M\+V\+I\+I\+::\+Add\+Data (
\begin{DoxyParamCaption}
\item[{const {\bf c\+Aux\+Ar2007} \&}]{an\+Aux, }
\item[{int \&}]{a\+Val}
\end{DoxyParamCaption}
)}\hypertarget{Serial_8cpp_file_adde69c2a8c2c7ab9f0d4a04d8a8928e8}{}\label{Serial_8cpp_file_adde69c2a8c2c7ab9f0d4a04d8a8928e8}


for int 

Here are the atomic serialization function 

Definition at line 116 of file Serial.\+cpp.


\begin{DoxyCode}
116 \{anAux.Ar().TplAddDataTerm(anAux,aVal); \}
\end{DoxyCode}
\index{Serial.\+cpp@{Serial.\+cpp}!Alloc\+Ar\+From\+File@{Alloc\+Ar\+From\+File}}
\index{Alloc\+Ar\+From\+File@{Alloc\+Ar\+From\+File}!Serial.\+cpp@{Serial.\+cpp}}
\subsubsection[{\texorpdfstring{Alloc\+Ar\+From\+File(const std\+::string \&a\+Name, bool Input)}{AllocArFromFile(const std::string &aName, bool Input)}}]{\setlength{\rightskip}{0pt plus 5cm}c\+Ar2007 $\ast$ M\+M\+V\+I\+I\+::\+Alloc\+Ar\+From\+File (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{a\+Name, }
\item[{bool}]{Input}
\end{DoxyParamCaption}
)}\hypertarget{Serial_8cpp_file_ad5a8ee3ebd0b0c4fe5d6ca6e18410bd2}{}\label{Serial_8cpp_file_ad5a8ee3ebd0b0c4fe5d6ca6e18410bd2}


Create an archive structure, its type (xml, binary, text) is determined by extension. 

Implementation of Alloc\+Ar\+From\+File. The type is fixed by string postfix , but we need to know if its for input or for output

Return a unique\+\_\+ptr as it used in Save\+In\+File/\+Read\+In\+File and destroy after 

Definition at line 608 of file Serial.\+cpp.


\begin{DoxyCode}
609 \{
610    std::string aPost = Postfix(aName,\textcolor{charliteral}{'.'},\textcolor{keyword}{true});
611 \textcolor{comment}{// StdOut() << "AllocArFromFile, " << aName << " => " << aPost << "\(\backslash\)n";}
612    cAr2007 * aRes = \textcolor{keyword}{nullptr};
613 
614    \textcolor{keywordflow}{if} (aPost==\textcolor{stringliteral}{"xml"})
615    \{
616        \textcolor{keywordflow}{if} (Input)
617           aRes =  \textcolor{keyword}{new} cIXml\_Ar2007(aName);
618        \textcolor{keywordflow}{else}
619           aRes =  \textcolor{keyword}{new} cOXml\_Ar2007(aName);
620    \}
621    \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((aPost==\textcolor{stringliteral}{"dmp"}) || (aPost==\textcolor{stringliteral}{"dat"}))
622    \{
623        \textcolor{keywordflow}{if} (Input)
624           aRes =  \textcolor{keyword}{new} cIBin\_Ar2007(aName);
625        \textcolor{keywordflow}{else}
626           aRes =  \textcolor{keyword}{new} cOBin\_Ar2007(aName);
627    \}
628 
629    MMVII\_INTERNAL\_ASSERT\_always(aRes!=0,\textcolor{stringliteral}{"Do not handle postfix for "}+ aName);
630    \textcolor{keywordflow}{return} aRes;
631 \}
\end{DoxyCode}
